# Nix Home Manager Configuration
A modular, feature-flagged Nix configuration supporting both standalone Home Manager (WSL, Ubuntu, etc.) and full NixOS systems.
## Quick Installation

Prerequisites
Install Nix with the [Determinate Systems installer](https://github.com/DeterminateSystems/nix-installer):
```bash
curl --proto '=https' --tlsv1.2 -sSf -L https://install.determinate.systems/nix | sh -s -- install
```

Automated Setup
Clone and install in one command:
```bash
nix run nixpkgs#git -- clone https://github.com/yourusername/home-manager ~/home-manager && \
cd ~/home-manager && \
nix flake update && \
nix run home-manager/master -- switch --flake ~/home-manager#<system-name>
```
Note: Replace <system-name> with your system name (see Configuration section below).

## ğŸ“ Directory Structure
```bash
~/home-manager/
â”œâ”€â”€ flake.nix                    # Main configuration entry point
â”œâ”€â”€ flake.lock                   # Locked dependency versions
â”œâ”€â”€ home.nix                     # Shared home configuration
â”œâ”€â”€ hosts/
â”‚   â”œâ”€â”€ wsl/                     # WSL configuration (isNixOS = false)
â”‚   â”‚   â””â”€â”€ default.nix          # Feature toggles for WSL
â”‚   â”œâ”€â”€ laptop/                  # NixOS laptop (isNixOS = true)
â”‚   â”‚   â”œâ”€â”€ configuration.nix    # NixOS system configuration
â”‚   â”‚   â”œâ”€â”€ hardware-configuration.nix
â”‚   â”‚   â””â”€â”€ home.nix             # Host-specific home features
â”‚   â””â”€â”€ work/                    # Example: work machine
â”‚       â””â”€â”€ default.nix
â””â”€â”€ modules/
    â”œâ”€â”€ environments/            # Development environments
    â”‚   â”œâ”€â”€ node/
    â”‚   â”œâ”€â”€ python/
    â”‚   â”œâ”€â”€ rust/
    â”‚   â””â”€â”€ go/
    â”œâ”€â”€ editors/                 # Editor configurations
    â”‚   â”œâ”€â”€ neovim.nix
    â”‚   â””â”€â”€ vscode.nix
    â”œâ”€â”€ terminal/                # Terminal tools
    â”‚   â”œâ”€â”€ zsh/
    â”‚   â”œâ”€â”€ tmux.nix
    â”‚   â””â”€â”€ starship.nix
    â””â”€â”€ tools/                   # CLI tools
        â”œâ”€â”€ git.nix
        â”œâ”€â”€ cli-tools.nix
        â”œâ”€â”€ docker.nix
        â””â”€â”€ direnv.nix
```

## Configuration
### Adding Your System
Edit flake.nix and add your system to the hosts attribute set:
```nix
nixhosts = {
  wsl = {
    username = "your-username";           # Change this
    homeDirectory = "/home/your-username"; # Change this
    hostConfig = ./hosts/wsl;
    isNixOS = false;  # false = Standalone Home Manager
  };

  # Add more systems as needed:
  laptop = {
    username = "john";
    homeDirectory = "/home/john";
    hostConfig = ./hosts/laptop;
    isNixOS = true;   # true = Full NixOS system
  };
};
```
### Configuring Features
Enable/disable features in hosts/<system>/default.nix:
```nix
nix{ config, lib, pkgs, ... }:

{
  features = {
    # Development Environments
    environments = {
      node.enable = true;
      python.enable = true;
      rust.enable = false;
      go.enable = false;
    };

    # Editors
    editors = {
      neovim.enable = true;
      vscode.enable = false;
    };

    # Terminal
    terminal = {
      zsh.enable = true;
      tmux.enable = true;
      starship.enable = true;
    };

    # Tools
    tools = {
      git.enable = true;
      cliTools.enable = true;
      docker.enable = true;
      direnv.enable = true;
    };
  };
}
```

## Applying Changes
Standalone Home Manager (WSL, Ubuntu, etc.)
```bash
# Full command
home-manager switch --flake ~/home-manager#wsl

# Or use the built-in alias (after first install)
hms
```
NixOS Systems
```bash
# Rebuild entire system (requires sudo)
sudo nixos-rebuild switch --flake ~/home-manager#laptop

# Or just rebuild Home Manager portion
home-manager switch --flake ~/home-manager#laptop
```

## What You Need Per Host Type

### For `isNixOS = false` (WSL, Ubuntu, Fedora, etc.)

Only needs a feature toggle file:
```bash
hosts/wsl/
â””â”€â”€ default.nix  # Your feature enables/disables
```

### For `isNixOS = true` (NixOS Systems)

Requires system configuration files:
```bash
hosts/laptop/
â”œâ”€â”€ configuration.nix         # Required: NixOS system config
â”œâ”€â”€ hardware-configuration.nix # Required: Generated by nixos-generate-config
â””â”€â”€ home.nix                  # Optional: Host-specific home features
```

## Common Tasks
Update Dependencies
```bash
cd ~/home-manager
nix flake update
hms  # or home-manager switch --flake ~/home-manager#wsl
```

### Add New Host
Add entry to hosts in flake.nix
Create hosts/<new-system>/default.nix
Set isNixOS = true/false flag
Apply: home-manager switch --flake ~/home-manager#<new-system>
